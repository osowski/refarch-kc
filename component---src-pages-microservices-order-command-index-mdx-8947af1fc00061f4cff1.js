(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{DqQm:function(e,t,r){"use strict";r.r(t),r.d(t,"_frontmatter",(function(){return i})),r.d(t,"default",(function(){return u}));r("91GP"),r("rGqo"),r("yt8O"),r("Btvt"),r("RW0V"),r("q1tI");var a=r("7ljp"),n=r("013z");r("qKvR");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var i={},c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(a.b)("div",t)}},s=c("InlineNotification"),l=c("PageDescription"),b=c("AnchorLinks"),p=c("AnchorLink"),m={_frontmatter:i},d=n.a;function u(e){var t=e.components,r=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,["components"]);return Object(a.b)(d,o({},m,r,{components:t,mdxType:"MDXLayout"}),Object(a.b)(s,{kind:"warning",mdxType:"InlineNotification"},"UNDER CONSTRUCTION"),Object(a.b)(l,{mdxType:"PageDescription"},"This project is demonstrating, one of the possible implementation of the Command Query Responsibility Segregation and event sourcing patterns applied to Reefer shipment order subdomain. It is part of the Event Driven Architecture solution implementation. From a use case point of view, it implements the order management component, responsible to manage the full life cycle of a shipping order issued by a customer who wants to ship fresh goods overseas."),Object(a.b)(b,{mdxType:"AnchorLinks"},Object(a.b)(p,{mdxType:"AnchorLink"},"Overview"),Object(a.b)(p,{mdxType:"AnchorLink"},"Build"),Object(a.b)(p,{mdxType:"AnchorLink"},"Run"),Object(a.b)(p,{mdxType:"AnchorLink"},"Integration Tests"),Object(a.b)(p,{mdxType:"AnchorLink"},"Implementation Details")),Object(a.b)("h2",null,"Overview"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Description:")," Main goal of the Orders component is to manage the shipping orders. This component is made up of two microservices, one called Order Command and the other Order Query. The reason for this component to be split into two microservices is to implement the ",Object(a.b)("a",o({parentName:"p"},{href:"#command-query-responsibility-segregation-(cqrs)"}),Object(a.b)("strong",{parentName:"a"},"Command Query Responsibility Segregation (CQRS)"))," pattern."),Object(a.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1024px"}},"\n      ",Object(a.b)("span",o({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"56.25%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAvXAAAL1wElddLwAAABM0lEQVQoz42RzUrDQBDH86K+gdCLeFNE6F16sKdCwRfwDbx5ETWSSE42NG0+mqTtJiab/ZrVWaNiaYL9sywzu/ObmZ21Pg6Q1rrz3NqLM3uU0/PJ68m148wKdKuaKdBKaal28vTBzeXUOx077oxoAGTaKzQAdDfMOS/LkjFB64pzFkWJ/fyY5esoToJgjgFYH/QurJRijEkp0UCmqhvMgk6ab5bLBW1YskqzLMWOGRdCSADAyG8YSd/3CSHG5jyOV4xLLgCXeXBFCSnaUthXURgbK2Euqx0m7EkphCWSNWXle1NXNdY0veHFlzoG9legRJ4EYRhutiXJYw3in6/6Hfi64BdT72zizpMK3fHt22D0cu/mJunPzHrhdMsGI/v4yl6kFN3hjXc0fLh7Sg0M/fDh+gSh1Hldq3oC5gAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(a.b)("img",o({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Order Command diagram",title:"Order Command diagram",src:"/refarch-kc/static/4a05192fa4816fc56a3079aeed53916a/2faef/microservice-overview-order-command.png",srcSet:["/refarch-kc/static/4a05192fa4816fc56a3079aeed53916a/7fc1e/microservice-overview-order-command.png 288w","/refarch-kc/static/4a05192fa4816fc56a3079aeed53916a/a5df1/microservice-overview-order-command.png 576w","/refarch-kc/static/4a05192fa4816fc56a3079aeed53916a/2faef/microservice-overview-order-command.png 1024w"],sizes:"(max-width: 1024px) 100vw, 1024px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(a.b)("p",null,"This microservice implements the write logic in the CQRS pattern. That is, will be in charge of managing the state of shipping orders."),Object(a.b)("p",null,"This microservice has been implemented using MicroProfile 3.0. and runs on OpenLiberty."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Github repository:")," ",Object(a.b)("a",o({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms"}),"refarch-kc-order-ms")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Folder:")," ",Object(a.b)("a",o({parentName:"p"},{href:"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/order-command-ms"}),"order-command-ms")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Kafka topics consumed from:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-commands-topic"}),"Order Commands Topic")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#orders-topic"}),"Order Topic"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Kafka topics produced to:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-commands-topic"}),"Order Commands Topic")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#orders-topic"}),"Order Topic")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#errors-topic"}),"Errors Topic"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Events reacted to:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-command-event"}),"Order Command Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#container-allocated-event"}),"Container Allocated Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#container-not-found-event"}),"Container Not Found Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#voyage-assigned-event"}),"Voyage Assigned Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#voyage-not-found-event"}),"Voyage Not Found Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-spoilt-event"}),"Order Spoilt Event"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Events produced:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-command-event"}),"Order Command Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-created-event"}),"Order Created Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-updated-event"}),"Order Updated Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-reject-event"}),"Order Reject Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-cancel-event"}),"Order Cancel Event")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#error-event"}),"Error Event"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"EDA Patterns implemented:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#command-query-responsibility-segregation-(cqrs)"}),"Command Query Responsibility Segregation (CQRS)")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#saga"}),"SAGA")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#consume-transform-produce-loop"}),"Consume-transform-produce Loop")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"#order-cancellation"}),"Order Cancellation"))),Object(a.b)("h2",null,"Build"),Object(a.b)("p",null,"TBD Appsody"),Object(a.b)("h2",null,"Run"),Object(a.b)("p",null,"TBD Appsody"),Object(a.b)("h2",null,"Integration Tests"),Object(a.b)("p",null,"TBD"),Object(a.b)("h2",null,"Implementation Details"),Object(a.b)("p",null,"TBD Merge the following:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/docs/implementation-considerations.md"}),"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/docs/implementation-considerations.md")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/docs/ddd-applied.md"}),"https://github.com/ibm-cloud-architecture/refarch-kc-order-ms/blob/master/docs/ddd-applied.md"))),Object(a.b)("p",null,"This project is demonstrating, one of the possible implementation of the Command Query Responsibility Segregation and event sourcing patterns applied to Reefer shipment order subdomain. It is part of the Event Driven Architecture solution implementation. From a use case point of view, it implements the order management component, responsible to manage the full life cycle of a shipping order issued by a customer who wants to ship fresh goods overseas. The business process is defined here and the event storming analysis in this note. We are also presenting one way of applying Domain Drive Design practice for this subdomain."),Object(a.b)("p",null,"This microservice is part of a set that demonstrates the consume-transform-produce pattern has been used along with the Event Sourcing pattern and the commands concept in Event Driven Architectures to ensure that any request (command) from users is eventually attended and processed by our system."),Object(a.b)("p",null,"The most critical part is the processing of those commands published in the Order Commands Topic of our event backbone that correspond to customer requests. We want to be able to successfully process all of them regardless of how many actions these entail, making sure these actions are all executed and we get confirmation of those. We want to process these actions in a transaction-like manner so that a request is not successfully marked as processed unless all actions were successfully executed."),Object(a.b)("p",null,"The key of this loop is that the produced event to the Orders Topic as the last action of the request (so that all previous actions have successfully been executed already) will be produced along with the offset commitment for the command read as a transaction. That is, either both the event to the Orders Topic is produced and the offset for the command read from the Order Commands Topic is committed or none of them happen."),Object(a.b)("h3",null,"What you will learn"),Object(a.b)("p",null,"By studying this repository, you will be able to learn the following subjects:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"How to apply domain driven design for a CQRS microservice"),Object(a.b)("li",{parentName:"ul"},"How to adopt CQRS pattern for the shipping order management"),Object(a.b)("li",{parentName:"ul"},"How to apply ubiquituous language in the code"),Object(a.b)("li",{parentName:"ul"},"Develop and deploy a microprofile 2.2 application, using open Liberty, on openshift or kubernetes")),Object(a.b)("h3",null,"Requirements"),Object(a.b)("p",null,"The key business requirements we need to support are:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Be able to book a fresh product shipment order, including the allocation of the voyage and the assignment of a reefer container to the expected cargo."),Object(a.b)("li",{parentName:"ul"},"Be able to understand what happen to the order over time:",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"How frequently does an order get cancelled after it is placed but before an empty container is delivered to pick up location or loaded ?"),Object(a.b)("li",{parentName:"ul"},"Track key issue or step in the reefer shipment process"),Object(a.b)("li",{parentName:"ul"},"How often does an order get cancelled after the order is confirmed, a container assigned and goods loaded into it?"))),Object(a.b)("li",{parentName:"ul"},"Be able to support adhoc query on the order that span across subdomains of the shipment domain.",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"What are all events for a particular order and associated container shipment?"),Object(a.b)("li",{parentName:"ul"},"Has the cold chain been protected on this particular order?"),Object(a.b)("li",{parentName:"ul"},"How long it takes to deliver a fresh food order from california to China?")))),Object(a.b)("p",null,"Those requirements force use to consider event sourcing (understanding facts about the order over time) and CQRS patterns to separate queries from command so our architecture will be more flexible and may address different scaling requirements."))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-microservices-order-command-index-mdx-8947af1fc00061f4cff1.js.map